<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>raisaliky ‚Äî –±—ã—Å—Ç—Ä—ã–π Match-3</title>

<!-- –ü—Ä–µ–ª–æ–∞–¥ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ -->
<link rel="preload" href="1.png" as="image">
<link rel="preload" href="2.png" as="image">
<link rel="preload" href="3.png" as="image">
<link rel="preload" href="4.png" as="image">
<link rel="preload" href="5.png" as="image">
<link rel="preload" href="6.png" as="image">
<link rel="preload" href="bonus.png" as="image">
<link rel="preload" href="rewind.png" as="image">

<style>
  :root{
    --bg:#0b1327;
    --panel:#0e1424cc;
    --stroke:#243351;
    --text:#e5e7eb;
    --muted:#9fb1d6;
    --tile:72px;       /* —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏ */
    --gap:10px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(135deg,#0a1326,#09101f 55%, #070d1a);
    color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    display:flex; align-items:center; justify-content:center; padding:16px;
  }
  .wrap{display:grid; grid-template-columns: 320px auto; gap:16px; width:100%; max-width:1100px}
  .panel{
    padding:16px; border:1px solid var(--stroke); border-radius:16px; background:var(--panel);
  }
  h1{margin:0 0 6px; font-size:22px}
  .subtitle{margin:0 0 10px; color:var(--muted); font-size:14px; line-height:1.4}
  .hud{display:flex; gap:8px; margin:10px 0}
  .badge{flex:1; display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border:1px solid var(--stroke); border-radius:12px; background:#0d1732}
  .badge b{font-size:20px}
  .tools{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
  .power, .btn{
    display:inline-flex; align-items:center; gap:8px; border:1px solid var(--stroke); background:#0d1732;
    color:var(--text); padding:8px 10px; border-radius:10px; cursor:pointer; font-weight:700
  }
  .power img, .btn img{width:22px; height:22px}
  .power.active{outline:2px dashed #fbbf24}
  .note{color:#bfd1f8; font-size:12px; margin-top:8px}

  .board{display:grid; gap:var(--gap); background:rgba(255,255,255,.04); padding:var(--gap); border-radius:16px; border:1px solid var(--stroke)}
  .cell{width:var(--tile); height:var(--tile); border-radius:12px; display:grid; place-items:center; background:linear-gradient(180deg,#0f1a32,#0b1327)}
  .tile{
    width:calc(var(--tile) - 8px); height:calc(var(--tile) - 8px);
    display:grid; place-items:center; border-radius:10px; user-select:none; cursor:pointer;
    border:4px solid transparent; transition:transform .08s ease, border-color .12s ease;
    will-change: transform;
  }
  .tile.selected{outline:3px solid #60a5fa}
  .tile img{width:80%; height:80%; object-fit:contain}
  .toast{
    position:fixed; top:12px; left:50%; transform:translateX(-50%); background:#0f162bde; border:1px solid var(--stroke);
    color:#e5e7eb; padding:8px 10px; border-radius:10px; font-size:13px; opacity:0; pointer-events:none; transition:opacity .2s ease
  }
  .toast.show{opacity:1}

  @media (max-width: 980px){
    .wrap{grid-template-columns: 1fr}
    :root{ --tile:64px }
  }
</style>
</head>
<body>

<div class="wrap">
  <section class="panel">
    <h1>üê∂ raisaliky ‚Äî Match-3</h1>
    <p class="subtitle">
      –°–æ–±–∏—Ä–∞–π 3+ –ø–æ–¥—Ä—è–¥. –ú–æ–∂–Ω–æ <b>–∫–ª–∏–∫–Ω—É—Ç—å</b> –ø–æ —Å–æ—Å–µ–¥–Ω–∏–º –ø–ª–∏—Ç–∫–∞–º –¥–ª—è –æ–±–º–µ–Ω–∞ –∏–ª–∏ <b>–ø–µ—Ä–µ—Ç—è–Ω—É—Ç—å</b> –Ω–∞ —Å–æ—Å–µ–¥–Ω—é—é.
      –ú–∞—Ç—á –∏–∑ 4 –¥–∞—ë—Ç ‚≠ê, –∏–∑ 5 ‚Äî ‚≠ê‚≠ê. –ù–∞–∂–º–∏ ‚≠ê –∏ –∫–ª–∏–∫–Ω–∏ –ø–æ —Ç–∏–ø—É –ø–ª–∏—Ç–∫–∏ ‚Äî –≤—Å–µ —Ç–∞–∫–∏–µ –∏—Å—á–µ–∑–Ω—É—Ç.<br>
      <i>–ó–≤–µ–∑–¥–∞ –Ω–µ –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–≤–µ–∑–¥—ã.</i>
    </p>

    <div class="hud">
      <div class="badge"><span>–û—á–∫–∏</span><b id="score">0</b></div>
      <div class="badge"><span>–•–æ–¥—ã</span><b id="moves">0</b></div>
    </div>

    <div class="tools">
      <button class="power" id="starPower" title="–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å ‚≠ê">
        <img src="bonus.png" alt=""><span><b>‚≠ê</b> <span id="starCount">0</span></span>
      </button>
      <button class="btn" id="rewind"><img src="rewind.png" alt=""> Rewind</button>
      <button class="btn" id="newGame">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    </div>

    <div class="note">–°–æ–≤–µ—Ç: –µ—Å–ª–∏ —Ö–æ–¥ –Ω–µ –¥–∞—ë—Ç –º–∞—Ç—á ‚Äî –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è.</div>
  </section>

  <main>
    <div id="board" class="board" aria-label="–ü–æ–ª–µ"></div>
  </main>
</div>

<div id="toast" class="toast">–ü–æ–¥—Å–∫–∞–∑–∫–∞</div>

<script>
/* ================== –ë—ã—Å—Ç—Ä—ã–π, –æ–¥–Ω–æ—Ñ–∞–π–ª–æ–≤—ã–π –¥–≤–∏–∂–æ–∫ ================== */
/* –ö–æ–Ω—Ñ–∏–≥ */
const N = 8;                       // –ø–æ–ª–µ N x N
const TYPES = [1,2,3,4,5,6];       // —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 1.png ‚Ä¶ 6.png
const SCORE_PER_TILE = 10;
const STAR_REFILL_CHANCE = 0.00;   // —à–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è –∑–≤–µ–∑–¥—ã –ø—Ä–∏ –¥–æ–ª–∏–≤–∫–µ (–¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–∫–ª—é—á–∏–ª)
const DRAG_THRESHOLD = 14;

/* –°–æ—Å—Ç–æ—è–Ω–∏–µ */
let grid = [];                     // {type:number, star:boolean} | null
let score=0, moves=0;
let stars=0;
let starArmed=false;
let sel=null;                      // {r,c}
let snapshotState=null;            // –¥–ª—è rewind
let dragging=false, dragStart=null, suppressClick=false;
let awardStarsEnabled = true;      // —Ñ–ª–∞–≥ ‚Äî –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º ‚≠ê, –≤—ã–∫–ª—é—á–∞–µ–º –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ –∑–≤—ë–∑–¥–∞–º–∏

/* DOM */
const board = document.getElementById('board');
const scoreEl = document.getElementById('score');
const movesEl = document.getElementById('moves');
const starCountEl = document.getElementById('starCount');
const starBtn = document.getElementById('starPower');
const toastEl = document.getElementById('toast');

/* –£—Ç–∏–ª–∏—Ç—ã */
const rand = n => Math.floor(Math.random()*n);
const delay = ms => new Promise(r=>setTimeout(r,ms));
function toast(msg, ms=1100){ toastEl.textContent=msg; toastEl.classList.add('show'); setTimeout(()=>toastEl.classList.remove('show'), ms); }
function inb(r,c){ return r>=0 && c>=0 && r<N && c<N; }
function neighbors(a,b){ return (a.r===b.r && Math.abs(a.c-b.c)===1) || (a.c===b.c && Math.abs(a.r-b.r)===1); }

/* –¶–≤–µ—Ç —Ä–∞–º–∫–∏ –ø–æ —Ç–∏–ø—É */
function borderFor(t, star=false){
  if(star) return '#fbbf24';
  return ({1:'#60a5fa',2:'#34d399',3:'#f59e0b',4:'#f87171',5:'#a78bfa',6:'#22d3ee'})[t] || '#cbd5e1';
}

/* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: —É—á–∏—Ç—ã–≤–∞–µ–º .png / .PNG / .Png */
function candidatePaths(base){
  return [`${base}.png`, `${base}.PNG`, `${base}.Png`];
}
function setImgFallback(img, base, isStar=false){
  const paths = isStar ? ['bonus.png','bonus.PNG','bonus.Png'] : candidatePaths(base);
  let i=0;
  img.onerror = ()=>{ i++; if(i<paths.length) img.src=paths[i]; };
  img.src = paths[i];
}

/* –†–µ–Ω–¥–µ—Ä: —Å–æ–∑–¥–∞—ë–º —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ —Å–µ—Ç–∫—É –∏ –¥–∞–ª—å—à–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –º–µ–Ω—è—é—â–∏–µ—Å—è –∫–ª–µ—Ç–∫–∏ */
function buildDOM(){
  board.style.gridTemplateColumns = `repeat(${N}, var(--tile))`;
  board.innerHTML = '';
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      const cell = document.createElement('div'); cell.className='cell';
      const tile = document.createElement('div'); tile.className='tile'; tile.dataset.r=r; tile.dataset.c=c;
      const img = document.createElement('img'); tile.appendChild(img);
      cell.appendChild(tile); board.appendChild(cell);
    }
  }
}
function renderCell(r,c){
  const idx = r*N + c;
  const tile = board.children[idx].firstChild;
  const data = grid[r][c];
  tile.classList.toggle('selected', !!sel && sel.r===r && sel.c===c);
  tile.style.borderColor = data ? borderFor(data.type, data.star) : 'transparent';
  const img = tile.firstChild;
  if(!data){ img.removeAttribute('src'); return; }
  if(data.star) setImgFallback(img, 'bonus', true);
  else setImgFallback(img, String(data.type), false);
}
function renderHUD(){
  scoreEl.textContent = score;
  movesEl.textContent = moves;
  starCountEl.textContent = stars;
  starBtn.classList.toggle('active', starArmed);
}

/* –ú–æ–¥–µ–ª—å –ø–æ–ª—è */
function randomTile(){ return {type: TYPES[rand(TYPES.length)], star:false}; }
function snapshot(){ snapshotState = JSON.stringify({grid, score, moves, stars}); }
function restore(){ if(!snapshotState) return; const s=JSON.parse(snapshotState); grid=s.grid; score=s.score; moves=s.moves; stars=s.stars; sel=null; starArmed=false; renderAll(); }
function renderAll(){ for(let r=0;r<N;r++) for(let c=0;c<N;c++) renderCell(r,c); renderHUD(); }

function initGrid(){
  grid = Array.from({length:N}, ()=> Array.from({length:N}, randomTile));
  // —É–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –º–∞—Ç—á–∏
  while(findMatches().length) shuffleBoard();
}

function shuffleBoard(){
  const list=[]; for(let r=0;r<N;r++) for(let c=0;c<N;c++) list.push(grid[r][c]);
  for(let i=list.length-1;i>0;i--){ const j=rand(i+1); [list[i],list[j]]=[list[j],list[i]]; }
  let k=0; for(let r=0;r<N;r++) for(let c=0;c<N;c++){ grid[r][c]=list[k++]; }
}

/* –ü–æ–∏—Å–∫ –º–∞—Ç—á–µ–π >=3 ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≥—Ä—É–ø–ø –ø–æ–∑–∏—Ü–∏–π */
function findMatches(){
  const out=[];
  // —Å—Ç—Ä–æ–∫–∏
  for(let r=0;r<N;r++){
    let run=1;
    for(let c=1;c<=N;c++){
      const prev=grid[r][c-1], cur=(c<N?grid[r][c]:null);
      if(cur && prev && !prev.star && !cur.star && prev.type===cur.type) run++;
      else { if(run>=3) out.push(Array.from({length:run}, (_,i)=>({r, c:c-1-i}))); run=1; }
    }
  }
  // —Å—Ç–æ–ª–±—Ü—ã
  for(let c=0;c<N;c++){
    let run=1;
    for(let r=1;r<=N;r++){
      const prev=grid[r-1][c], cur=(r<N?grid[r][c]:null);
      if(cur && prev && !prev.star && !cur.star && prev.type===cur.type) run++;
      else { if(run>=3) out.push(Array.from({length:run}, (_,i)=>({r:r-1-i, c}))); run=1; }
    }
  }
  return out;
}

/* –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∏ –¥–æ–ª–∏–≤–∫–∞ ‚Äî –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –±–µ–∑ —Ç—è–∂—ë–ª—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π */
async function crush(matches, {awardStars=true}={}){
  if(!matches.length) return false;

  // –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –¥–ª–∏–Ω—É –º–∞—Ç—á–µ–π (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ)
  if(awardStars){
    for(const g of matches){
      if(g.length===4) { stars += 1; }
      else if(g.length>=5){ stars += 2; }
    }
  }

  // —É–¥–∞–ª—è–µ–º (null) –∏ —Å—á–∏—Ç–∞–µ–º –æ—á–∫–∏
  const seen=new Set(); let removed=0;
  for(const g of matches){
    for(const p of g){
      const key=p.r+','+p.c;
      if(!seen.has(key)){ seen.add(key); if(grid[p.r][p.c]!=null){ grid[p.r][p.c]=null; removed++; } }
    }
  }
  score += removed * SCORE_PER_TILE;

  // –ø–∞–¥–µ–Ω–∏–µ –≤–Ω–∏–∑ + –¥–æ–ª–∏–≤–∫–∞
  for(let c=0;c<N;c++){
    let write=N-1;
    for(let r=N-1;r>=0;r--){
      if(grid[r][c]!=null){ grid[write][c]=grid[r][c]; if(write!==r) grid[r][c]=null; write--; }
    }
    for(let r=write;r>=0;r--){
      const spawnStar = Math.random() < STAR_REFILL_CHANCE;
      grid[r][c] = spawnStar ? {type:TYPES[rand(TYPES.length)], star:true} : randomTile();
    }
  }

  // —Ä–µ—Ä–µ–Ω–¥–µ—Ä —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö: —Ä–∞–¥–∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã ‚Äî –≤—Å–µ–≥–æ –ø–æ–ª—è (–¥—ë—à–µ–≤–æ)
  renderAll();

  // —Ü–µ–ø–æ—á–∫–∏ (–∑–≤—ë–∑–¥—ã —Ç–æ–∂–µ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫–∏, –Ω–æ –±–µ–∑ –≤—ã–¥–∞—á–∏ –∑–≤—ë–∑–¥, –µ—Å–ª–∏ awardStars=false)
  const next = findMatches();
  if(next.length) return crush(next, {awardStars});
  return true;
}

/* –í—ã–¥–µ–ª–µ–Ω–∏–µ: –≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞ –ø–ª–∏—Ç–∫–∞ */
function setSelected(p){
  const old = sel; sel = p;
  if(old) renderCell(old.r, old.c);
  if(p) renderCell(p.r, p.c);
}

/* –û–±–º–µ–Ω –¥–≤—É—Ö –∫–ª–µ—Ç–æ–∫ */
async function attemptSwap(a,b){
  if(!neighbors(a,b)) return;
  // —Å–±–æ—Ä –∑–≤–µ–∑–¥—ã –∫–ª–∏–∫–æ–º/–ø–µ—Ä–µ—Ç—è–≥–∏–≤–∞–Ω–∏–µ–º
  if(grid[a.r][a.c]?.star){ stars++; grid[a.r][a.c]=randomTile(); renderCell(a.r,a.c); renderHUD(); toast('‚≠ê –î–æ–±–∞–≤–ª–µ–Ω–∞'); return; }
  if(grid[b.r][b.c]?.star){ stars++; grid[b.r][b.c]=randomTile(); renderCell(b.r,b.c); renderHUD(); toast('‚≠ê –î–æ–±–∞–≤–ª–µ–Ω–∞'); return; }

  snapshot();
  // –±—ã—Å—Ç—Ä—ã–π swap
  const t = grid[a.r][a.c]; grid[a.r][a.c]=grid[b.r][b.c]; grid[b.r][b.c]=t;
  renderCell(a.r,a.c); renderCell(b.r,b.c);

  const m = findMatches();
  if(!m.length){
    // –æ—Ç–∫–∞—Ç
    const tt = grid[a.r][a.c]; grid[a.r][a.c]=grid[b.r][b.c]; grid[b.r][b.c]=tt;
    renderCell(a.r,a.c); renderCell(b.r,b.c);
    setSelected(null);
    return;
  }
  moves++; renderHUD(); setSelected(null);
  await crush(m, {awardStars:true});
}

/* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–≤–µ–∑–¥—ã –Ω–∞ —Ç–∏–ø */
function useStarOnType(type){
  starArmed=false; renderHUD();
  // —É–±–∏—Ä–∞–µ–º –≤—Å–µ –ø–ª–∏—Ç–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ (–∫—Ä–æ–º–µ –∑–≤—ë–∑–¥)
  let removed=0;
  for(let r=0;r<N;r++) for(let c=0;c<N;c++){
    const t=grid[r][c];
    if(t && !t.star && t.type===type){ grid[r][c]=null; removed++; }
  }
  if(!removed){ toast('–ù–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–ª–∏—Ç–æ–∫'); return; }
  score += removed * SCORE_PER_TILE * 2;
  // –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –∑–≤–µ–∑–¥–æ–π ‚Äî –Ω–µ –≤—ã–¥–∞—ë–º –Ω–æ–≤—ã–µ –∑–≤–µ–∑–¥—ã –Ω–∏ –∑–∞ –≥—Ä—É–ø–ø—ã, –Ω–∏ –∑–∞ —Ü–µ–ø–æ—á–∫–∏
  crush(findMatches(), {awardStars:false});
}

/* === –í–≤–æ–¥: –∫–ª–∏–∫, –¥—Ä–∞–≥, —Ç–∞—á === */
board.addEventListener('click', (e)=>{
  if(suppressClick){ suppressClick=false; return; }
  const tile = e.target.closest('.tile'); if(!tile) return;
  const r=+tile.dataset.r, c=+tile.dataset.c;
  const t = grid[r][c];

  if(starArmed){
    if(t && !t.star) useStarOnType(t.type);
    else toast('–í—ã–±–µ—Ä–∏ –æ–±—ã—á–Ω—É—é –ø–ª–∏—Ç–∫—É');
    return;
  }

  if(t && t.star){
    stars++; grid[r][c]=randomTile(); renderCell(r,c); renderHUD(); toast('‚≠ê –î–æ–±–∞–≤–ª–µ–Ω–∞');
    return;
  }

  if(!sel){ setSelected({r,c}); return; }
  if(sel.r===r && sel.c===c){ setSelected(null); return; }
  if(neighbors(sel,{r,c})) attemptSwap(sel,{r,c});
  else setSelected({r,c});
});

/* –î—Ä–∞–≥ (–º—ã—à—å) */
board.addEventListener('mousedown',(e)=>{
  if(starArmed) return;
  const tile=e.target.closest('.tile'); if(!tile) return;
  dragging=true; suppressClick=false;
  dragStart={r:+tile.dataset.r, c:+tile.dataset.c, x:e.clientX, y:e.clientY};
  setSelected({r:dragStart.r, c:dragStart.c});
});
window.addEventListener('mousemove',(e)=>{
  if(!dragging||!dragStart) return;
  const dx=e.clientX-dragStart.x, dy=e.clientY-dragStart.y;
  if(Math.abs(dx)<DRAG_THRESHOLD && Math.abs(dy)<DRAG_THRESHOLD) return;
  const a={r:dragStart.r,c:dragStart.c};
  let b=null;
  if(Math.abs(dx)>Math.abs(dy)){ b={r:a.r, c:a.c+(dx>0?1:-1)}; } else { b={r:a.r+(dy>0?1:-1), c:a.c}; }
  if(inb(b.r,b.c)){ suppressClick=true; attemptSwap(a,b); }
  dragging=false; dragStart=null;
});
window.addEventListener('mouseup',()=>{ dragging=false; dragStart=null; });

/* –¢–∞—á */
board.addEventListener('touchstart',(e)=>{
  if(starArmed) return;
  const t=e.changedTouches[0];
  const tile=e.target.closest('.tile'); if(!tile) return;
  dragging=true; suppressClick=false;
  dragStart={r:+tile.dataset.r, c:+tile.dataset.c, x:t.clientX, y:t.clientY};
  setSelected({r:dragStart.r, c:dragStart.c});
},{passive:true});
board.addEventListener('touchmove',(e)=>{
  if(!dragging||!dragStart) return;
  const t=e.changedTouches[0], dx=t.clientX-dragStart.x, dy=t.clientY-dragStart.y;
  if(Math.abs(dx)<DRAG_THRESHOLD && Math.abs(dy)<DRAG_THRESHOLD) return;
  const a={r:dragStart.r,c:dragStart.c};
  let b=null;
  if(Math.abs(dx)>Math.abs(dy)){ b={r:a.r, c:a.c+(dx>0?1:-1)}; } else { b={r:a.r+(dy>0?1:-1), c:a.c}; }
  if(inb(b.r,b.c)){ suppressClick=true; attemptSwap(a,b); }
  dragging=false; dragStart=null;
},{passive:true});
board.addEventListener('touchend',()=>{ dragging=false; dragStart=null; },{passive:true});

/* –ö–Ω–æ–ø–∫–∏ */
document.getElementById('newGame').addEventListener('click', ()=>{ newGame(); });
document.getElementById('rewind').addEventListener('click', ()=>{ restore(); toast('‚Ü∫ –û—Ç–∫–∞—Ç'); });
starBtn.addEventListener('click', ()=>{
  if(stars<=0){ toast('–ù–µ—Ç –∑–≤—ë–∑–¥'); return; }
  stars--; starArmed=true; renderHUD(); toast('‚≠ê –í—ã–±–µ—Ä–∏ —Ç–∏–ø –ø–ª–∏—Ç–∫–∏');
});

/* –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª */
function newGame(){
  score=0; moves=0; stars=0; starArmed=false; sel=null; snapshotState=null;
  buildDOM(); initGrid(); renderAll();
}
newGame();
</script>
</body>
</html>
